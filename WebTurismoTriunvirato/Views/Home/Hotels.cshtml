@model IEnumerable<Web_Turismo_Triunvirato.Models.HotelPromotion>
@using Web_Turismo_Triunvirato.Models.ViewModels
@using System.Globalization;

@{
    ViewData["Title"] = "Hospedaje";
}
<link rel="stylesheet" href="~/css/vuelos.css" />

<div class="flight-search-container">
    <h4>Encuentra tu Hospedaje ideal</h4>
    <div class="flight-search-options">
        <label>
            <input type="radio" name="flight-type" value="round-trip" checked> Ida y Vuelta
        </label>
        <label>
            <input type="radio" name="flight-type" value="one-way"> Solo Ida
        </label>
        <label>
            <input type="radio" name="flight-type" value="multi-destination"> Multidestino
        </label>
    </div>
    <div class="flight-search-inputs">
        <div class="input-group">
            <label for="origin">Origen</label>
            <input type="text" id="origin" placeholder="Ingresa ciudad, pa√≠s o regi√≥n">
        </div>
        <div class="input-group">
            <label for="destination">Destino</label>
            <input type="text" id="destination" placeholder="¬øAd√≥nde vas?">
        </div>
        <div class="input-group">
            <label for="departure-date">Fecha de Ida</label>
            <input type="date" id="departure-date">
        </div>
        <div class="input-group">
            <label for="return-date">Fecha de Vuelta</label>
            <input type="date" id="return-date">
        </div>
        <div class="input-group">
            <label for="passengers">Pasajeros, Clase</label>
            <select id="passengers">
                <option value="1">1 pasajero, Econ√≥mica</option>
                <option value="2">2 pasajeros, Econ√≥mica</option>
            </select>
        </div>
        <button class="search-button">Buscar</button>
    </div>
    <div class="more-options">
        <label>
            <input type="checkbox"> Ver fechas m√°s baratas
        </label>
    </div>
</div>

<section class="destinations-section">
    <h4 style="color:darkblue">Destinos Populares</h4>
    <div class="destinations-grid">
        @if (Model != null && Model.Any())
        {
            @foreach (var promotion in Model)
            {
               
                string estrellasVisuales = "";
                for (int i = 0; i < promotion.Stars; i++)
                {
                    estrellasVisuales += "‚òÖ"; 
                }

                var modalVM = new ModalContratoViewModel
                {
                    IdItem = promotion.Id,
                    Title = promotion.DestinationName,
                    ImageUrl = Url.Content(promotion.ImageUrl),
                    Price = promotion.OfferPrice,

                    // --- PASO CLAVE: Pasamos la colecci√≥n de im√°genes ---
                    GaleriaImagenes = promotion.ImagenesAdicionales,

                    PackageDetailsSerialized = $"Hotel: {promotion.HotelName} ({promotion.Stars} estrellas) | Destino: {promotion.DestinationName} | Precio: {promotion.OfferPrice:C} | Validez hasta: {promotion.EndDate:dd/MM/yyyy}",

                    LongDescription = $"<strong> üè® Hotel  {promotion.HotelName}</strong><br />" +
                $"<span style='color: #FFD700; font-size: 1.2em;'>{estrellasVisuales}</span><br /><br />" +
                $"{promotion.Description}<br /><br />" +
                $"Promoci√≥n v√°lida hasta el <span class='promo-fecha'>{promotion.EndDate:dd/MM/yyyy}</span>.",

                    RenderedWhatsappMessage = promotion.RenderedWhatsappMessage
                };

                var modalTargetId = $"packageModal-{modalVM.IdItem}";

                <div class="destination-card">
                    @if (promotion.IsHotWeek)
                    {
                        <span class="hot-week-badge">HOT WEEK</span>
                    }
                    else if (promotion.DiscountPercentage > 0)
                    {
                        <span class="discount-badge">¬°@promotion.DiscountPercentage.ToString("F0")% OFF!</span>
                    }

                    <div class="image-container">
                        <img src="@Url.Content(promotion.ImageUrl)" alt="@promotion.DestinationName">
                    </div>

                    <div class="destination-info">
                        <h3 class="mb-1">@promotion.DestinationName</h3>
                        <p class="price">
                           @promotion.OfferPrice.ToString("C0", new CultureInfo("es-AR"))
                        </p>
                        <p class="details-text">
                            <strong>@promotion.HotelName</strong><br />
                            @promotion.Description
                        </p>

                        <button type="button"
                                class="ver-detalles-button"
                                data-bs-toggle="modal"
                                data-bs-target="#@modalTargetId">
                            Ver Detalles
                        </button>
                    </div>
                </div>
                @await Html.PartialAsync("_MasInformacionGenerico", modalVM)
            }
        }
        else
        {
            <p class="col-12 alert alert-info text-center">No hay destinos populares de Hospedaje disponibles en este momento.</p>
        }
    </div>
</section>