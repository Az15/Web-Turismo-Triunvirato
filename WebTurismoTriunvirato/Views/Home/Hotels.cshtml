@model IEnumerable<Web_Turismo_Triunvirato.Models.HotelPromotion>  
@using Web_Turismo_Triunvirato.Models.ViewModels
@using System.Globalization;

@{
    ViewData["Title"] = "Hospedaje";
} 
<link rel="stylesheet" href="~/css/vuelos.css" />

<div class="flight-search-container">
    <h4>Encuentra tu Hospedaje ideal</h4>
    <div class="flight-search-options">
        <label>
            <input type="radio" name="flight-type" value="round-trip" checked> Ida y Vuelta
        </label>
        <label>
            <input type="radio" name="flight-type" value="one-way"> Solo Ida
        </label>
        <label>
            <input type="radio" name="flight-type" value="multi-destination"> Multidestino
        </label>
    </div>
    <div class="flight-search-inputs">
        <div class="input-group">
            <label for="origin">Origen</label>
            <input type="text" id="origin" placeholder="Ingresa ciudad, país o región">
        </div>
        <div class="input-group">
            <label for="destination">Destino</label>
            <input type="text" id="destination" placeholder="¿Adónde vas?">
        </div>
        <div class="input-group">
            <label for="departure-date">Fecha de Ida</label>
            <input type="date" id="departure-date">
        </div>
        <div class="input-group">
            <label for="return-date">Fecha de Vuelta</label>
            <input type="date" id="return-date">
        </div>
        <div class="input-group">
            <label for="passengers">Pasajeros, Clase</label>
            <select id="passengers">
                <option value="1">1 pasajero, Económica</option>
                <option value="2">2 pasajeros, Económica</option>
            </select>
        </div>
        <button class="search-button">Buscar</button>
    </div>
    <div class="more-options">
        <label>
            <input type="checkbox"> Ver fechas más baratas
        </label>
    </div>
</div>

<section class="destinations-section">
    <h4 style="color:darkblue">Destinos Populares</h4> @* Título actualizado *@
    <div class="destinations-grid">
        @if (Model != null && Model.Any())
        {

            @foreach (var promotion in Model)
{

    var modalVM = new ModalContratoViewModel
    {
        IdItem = promotion.Id, // Se mapea el Id
        Title = promotion.DestinationName, // Título principal del modal
        ImageUrl = Url.Content(promotion.ImageUrl), // URL de la imagen
        Price = promotion.OfferPrice, // Precio de la oferta
        
        // La descripción larga debe ser la más detallada disponible
        LongDescription = $"Hotel: {promotion.HotelName}. Calificación: {promotion.Stars} estrellas.", 
        
        // Texto de detalle para la parte superior del modal
        DetailText = $"Servicio: {promotion.ServiceType} | {promotion.Description}", 
        
        // Datos para el formulario de Mail/WhatsApp
        RenderedWhatsappMessage = promotion.RenderedWhatsappMessage,
        // (Otros campos como WhatsappNumber si el ViewModel los tiene)
    };
    
    var modalTargetId = $"packageModal-{modalVM.IdItem}"; // ID ÚNICO

    <div class="destination-card">
        @* BADGES (se mantienen igual) *@
        @if (promotion.IsHotWeek)
        {
            <span class="hot-week-badge">HOT WEEK</span>
        }
        else if (promotion.DiscountPercentage > 0)
        {
            <span class="discount-badge">¡@promotion.DiscountPercentage.ToString("F0")% OFF!</span>
        }

        @* CONTENEDOR DE IMAGEN *@
        <div class="image-container">
            <img src="@Url.Content(promotion.ImageUrl)" alt="@promotion.DestinationName">
        </div>

        @* NUEVA SECCIÓN DE INFORMACIÓN VISIBLE *@
        <div class="destination-info">

            <h3 class="mb-1">@promotion.DestinationName</h3>

            <p class="price">
                @promotion.OfferPrice.ToString("C0", new System.Globalization.CultureInfo("es-AR"))
            </p>

            <p class="details-text">
                @promotion.Description
            </p>

            @* BOTÓN DE ACCIÓN: Usa el ID generado por el ViewModel mapeado *@
            <button type="button"
                    class="ver-detalles-button"
                    data-bs-toggle="modal"
                    data-bs-target="#@modalTargetId">
                Ver Detalles
            </button>
            
            @* OPCIONAL: Botón de WhatsApp *@
            @* ... *@@* Aquí se ha quitado el código comentado para mantener la respuesta limpia. *@
            
        </div>
    </div>
    @await Html.PartialAsync("_MasInformacionGenerico", modalVM)
}
        }
        else
        {
            <p class="col-12 alert alert-info text-center">No hay destinos populares de Hospedaje disponibles en este momento.</p>

        }
    </div>
</section>
