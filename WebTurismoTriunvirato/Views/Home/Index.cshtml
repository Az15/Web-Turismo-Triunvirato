@using Web_Turismo_Triunvirato.ViewModels
@using System.Globalization; @* Necesario para CultureInfo para el formato de moneda *@

@model View_Index_Collection 
@* <--- ¡IMPORTANTE! Declarar el tipo de modelo esperado por la vista *@

@{
    ViewData["Title"] = "Bienvenido";
}

<head>
    <link rel="stylesheet" href="~/css/carrousel.css" />
    <link rel="stylesheet" href="~/css/package.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

@* Contenedor Principal del Carrusel *@
<div id="mainCarousel" class="carousel slide mt-2" data-bs-ride="carousel">
    <div class="carousel-inner">
        @{
            int carouselItemCount = 0; // Para controlar la clase 'active' del primer elemento del carrusel
        }

        @* Iterar sobre los elementos del carrusel desde el modelo *@
        @if (Model.DestinationCarrousel != null && Model.DestinationCarrousel.Any())
        {
            @foreach (var item in Model.DestinationCarrousel)
            {
                <div class="carousel-item @(carouselItemCount == 0 ? "active" : "")">
                    <img src="@item.ImageUrl" class="d-block w-100" alt="@item.AltText">
                    <div class="carousel-caption d-flex flex-column justify-content-end h-100">
                        <h5>@item.Title</h5>
                        <p><a href="@item.LinkUrl">Más información</a></p>
                    </div>
                </div>
                carouselItemCount++;
            }
        }
        else
        {
            @* Contenido de respaldo si el carrusel está vacío (opcional) *@
            <div class="carousel-item active">
                <img src="~/img/default-carousel-placeholder.jpg" class="d-block w-100" alt="No hay destinos disponibles">
                <div class="carousel-caption d-flex flex-column justify-content-end h-100">
                    <h5>No hay destinos disponibles en este momento.</h5>
                    <p><a href="/Contacto">Contáctanos para más información</a></p>
                </div>
            </div>
        }
    </div>

    @* Controles del Carrusel (flechas) *@
    <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </button>
</div>

@* Sección de "Paquetes más vendidos" *@
<div class="container mt-4">
    <h3>Paquetes más vendidos</h3>
    <div class="row flex-nowrap overflow-auto mt-4">

        @* Iterar sobre los destinos populares desde el modelo *@
        @if (Model.PopularDestinations != null && Model.PopularDestinations.Any())
        {
            @foreach (var item in Model.PopularDestinations)
            {
                <div class="col-md-4">
                    <div class="card rounded-3 shadow-sm d-flex flex-row">
                        <img src="@item.PictureDestiny" class="card-img-left rounded-start-3" alt="@item.Title" style="width: 150px; height: 120px; object-fit: cover;">
                        <div class="card-body d-flex flex-column justify-content-between p-3">
                            <div>
                                @if (!string.IsNullOrEmpty(item.TripType))
                                {
                                    <h6 class="card-subtitle text-muted small">@item.TripType</h6> @* Usamos la nueva propiedad TripType *@
                                }
                                <h5 class="card-title mb-0">@item.Title</h5>
                                <p class="card-text small mt-2">
                                    <span class="fw-bold">@item.Price.ToString("C", new CultureInfo("es-AR"))</span><br> @* Formato de moneda para Argentina *@
                                    @item.From
                                </p>
                            </div>
                            <a href="@item.DetailDestinyURL" class="btn btn-primary btn-sm w-100">Ver más</a>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            @* Contenido de respaldo si no hay destinos populares (opcional) *@
            <div class="col-12 text-center text-muted">
                <p>No hay paquetes más vendidos disponibles en este momento.</p>
            </div>
        }

    </div>
</div>